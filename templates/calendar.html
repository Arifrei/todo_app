{% extends 'base.html' %}

{% block content %}
<div id="calendar-page" class="calendar-page">
    <section id="calendar-month-card" class="calendar-month card">
        <div class="calendar-month-header">
            <div class="calendar-month-nav">
                <button class="btn-icon" id="calendar-prev-month" aria-label="Previous month"><i class="fa-solid fa-chevron-left"></i></button>
                <div class="calendar-month-label-wrap">
                    <div id="calendar-month-label" class="calendar-month-label"></div>
                    <div class="calendar-month-sub">Click: quick add &bull; Double-click: full view</div>
                </div>
                <div class="calendar-month-nav-right">
                    <button class="btn-icon" id="calendar-next-month" aria-label="Next month"><i class="fa-solid fa-chevron-right"></i></button>
                    <div class="calendar-month-menu">
                        <button class="btn-icon calendar-month-menu-btn" id="calendar-month-menu-btn" aria-label="Calendar options" title="Options" aria-controls="calendar-month-dropdown" aria-expanded="false">
                            <i class="fa-solid fa-ellipsis-vertical"></i>
                        </button>
                        <div class="calendar-month-dropdown" id="calendar-month-dropdown">
                            <button class="calendar-month-menu-item" id="calendar-today-month-btn">
                                <i class="fa-solid fa-calendar-day"></i> Today
                            </button>
                            <button class="calendar-month-menu-item" id="calendar-search-toggle" aria-controls="calendar-search-panel" aria-expanded="false">
                                <i class="fa-solid fa-magnifying-glass"></i> Search
                            </button>
                            <button class="calendar-month-menu-item" id="calendar-go-to-btn">
                                <i class="fa-solid fa-calendar-check"></i> Go to date
                            </button>
                            <button class="calendar-month-menu-item" id="calendar-recurring-btn">
                                <i class="fa-solid fa-repeat"></i> Recurring items
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <section class="calendar-search is-hidden" id="calendar-search-panel">
            <div class="calendar-search-bar">
                <i class="fa-solid fa-magnifying-glass"></i>
                <input type="search" id="calendar-search-input" class="form-control" placeholder="Search events and tasks" autocomplete="off" aria-label="Search events and tasks">
                <button class="btn-icon calendar-search-clear is-hidden" id="calendar-search-clear" aria-label="Clear search" title="Clear">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            <div id="calendar-search-results" class="calendar-search-results is-hidden"></div>
        </section>
        <div class="calendar-weekdays">
            <span>Sun</span><span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span>
        </div>
        <div id="calendar-month-grid" class="calendar-month-grid"></div>
    </section>

    <!-- Quick Add Section (appears on single click) -->
    <section id="calendar-quick-add-panel" class="calendar-quick-add-panel is-hidden">
        <div class="calendar-quick-add-header">
            <div id="calendar-quick-add-date" class="calendar-quick-add-date">Select a day</div>
            <button class="btn-icon" id="calendar-quick-add-close" aria-label="Close"><i class="fa-solid fa-times"></i></button>
        </div>
        <div class="calendar-quick-add-input-row">
            <textarea id="calendar-month-quick-input" class="form-control" rows="2" placeholder="Type your task and press Enter" disabled aria-label="Month quick add input"></textarea>
        </div>
        <div class="quick-hint">
            Type your task and press <kbd>Enter</kbd>. Use <strong>$</strong> <strong>#</strong> <strong>></strong> <strong>@</strong> <strong>!</strong> <strong>*</strong> <strong>?</strong> <strong>&amp;</strong> <strong>-</strong>
            <button class="link-btn" id="calendar-quick-help-toggle" type="button" aria-controls="calendar-quick-syntax-guide" aria-expanded="false">Show syntax guide</button>
        </div>
        <div class="calendar-syntax-guide is-hidden" id="calendar-quick-syntax-guide">
            <div class="syntax-guide-row"><strong>$</strong> Event (e.g., <code>$ Meeting @3pm</code>)</div>
            <div class="syntax-guide-row"><strong>#Name</strong> Create phase or <code>Task #Work</code> to assign</div>
            <div class="syntax-guide-row"><strong>>Name</strong> Create group or <code>Task >ProjectA</code> to assign</div>
            <div class="syntax-guide-row"><strong>@</strong> Time (e.g., <code>@3pm-5pm</code>)</div>
            <div class="syntax-guide-row"><strong>!</strong> Priority (e.g., <code>!h</code> !m !l)</div>
            <div class="syntax-guide-row"><strong>*</strong> Reminder (e.g., <code>*30m</code>, <code>*2h</code>, <code>*1d</code>)</div>
            <div class="syntax-guide-row"><strong>?</strong> Overlap (events allow overlap; tasks disallow overlap)</div>
            <div class="syntax-guide-row"><strong>&amp;</strong> Timeline only (hide from list view)</div>
            <div class="syntax-guide-row"><strong>-</strong> Disable rollover (prevents task from rolling to next day)</div>
        </div>
    </section>

    <section id="calendar-day-view" class="calendar-day-view is-hidden">
        <header class="calendar-header">
            <div class="calendar-date-nav">
                <button class="btn-icon" id="calendar-prev-day" aria-label="Previous day"><i class="fa-solid fa-chevron-left"></i></button>
                <div class="calendar-date-display">
                    <div id="calendar-day-label" class="calendar-day-label">Pick a day</div>
                    <div class="calendar-day-sub">
                        <input type="date" id="calendar-date-picker" class="calendar-date-picker" disabled>
                        <button class="btn btn-secondary btn-small" id="calendar-today-btn">Today</button>
                    </div>
                </div>
                <button class="btn-icon" id="calendar-next-day" aria-label="Next day"><i class="fa-solid fa-chevron-right"></i></button>
            </div>
            <div class="calendar-actions">
                <div class="calendar-view-mode-menu" id="calendar-view-mode-menu">
                    <button class="btn btn-secondary btn-small calendar-view-mode-trigger" id="calendar-view-mode-btn" type="button" aria-label="Change day view" aria-controls="calendar-view-mode-dropdown" aria-expanded="false">
                        <i class="fa-solid fa-clock"></i><span>Timeline</span><i class="fa-solid fa-chevron-down chevron"></i>
                    </button>
                    <div class="calendar-view-mode-dropdown" id="calendar-view-mode-dropdown">
                        <button class="calendar-view-mode-option" type="button" data-view-mode="list">List</button>
                        <button class="calendar-view-mode-option" type="button" data-view-mode="timeline">Timeline</button>
                    </div>
                </div>
                <div class="calendar-sort-menu">
                    <button class="btn btn-secondary btn-icon-only" id="calendar-day-sort-btn" aria-label="Sort day items" title="Sort: Time" aria-controls="calendar-day-sort-menu" aria-expanded="false">
                        <i class="fa-solid fa-arrow-down-wide-short"></i>
                    </button>
                    <div class="calendar-sort-dropdown" id="calendar-day-sort-menu">
                        <button class="calendar-sort-option" data-sort="time">Time</button>
                        <button class="calendar-sort-option" data-sort="title">Title</button>
                        <button class="calendar-sort-option" data-sort="priority">Priority</button>
                        <button class="calendar-sort-option" data-sort="status">Status</button>
                        <button class="calendar-sort-option" data-sort="manual">Manual</button>
                    </div>
                </div>
                <button class="btn btn-secondary btn-icon-text" id="calendar-back-month" type="button" aria-label="Back to month view">
                    <i class="fa-solid fa-calendar-days"></i><span class="btn-text">Back</span>
                </button>
                <div class="calendar-actions-menu">
                    <button class="btn btn-secondary btn-icon-only" id="calendar-menu-btn" aria-label="More options" title="More options" aria-controls="calendar-dropdown-menu" aria-expanded="false">
                        <i class="fa-solid fa-ellipsis-vertical"></i>
                    </button>
                    <div class="calendar-dropdown-menu" id="calendar-dropdown-menu">
                        <button class="calendar-menu-item" id="calendar-enable-notify">
                            <i class="fa-solid fa-bell"></i> Enable Notifications
                        </button>
                        <button class="calendar-menu-item" id="calendar-rollover-btn">
                            <i class="fa-solid fa-rotate"></i> Run Rollover
                        </button>
                        <button class="calendar-menu-item" id="calendar-send-digest">
                            <i class="fa-solid fa-envelope"></i> Email Digest
                        </button>
                        <button class="calendar-menu-item" id="calendar-sort-mobile-toggle" aria-controls="calendar-sort-mobile" aria-expanded="false">
                            <i class="fa-solid fa-arrow-down-wide-short"></i> Sort
                        </button>
                        <div class="calendar-sort-mobile" id="calendar-sort-mobile">
                            <button class="calendar-sort-option" data-sort="time">Time</button>
                            <button class="calendar-sort-option" data-sort="title">Title</button>
                            <button class="calendar-sort-option" data-sort="priority">Priority</button>
                            <button class="calendar-sort-option" data-sort="status">Status</button>
                            <button class="calendar-sort-option" data-sort="manual">Manual</button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <section class="calendar-board card">
            <div id="calendar-bulk-bar" class="bulk-actions u-hidden">
                <div class="bulk-left">
                    <input type="checkbox" id="calendar-select-all">
                    <label for="calendar-select-all" class="u-cursor-pointer">Select all</label>
                    <span id="calendar-bulk-count" class="u-text-muted u-ml-05">0 selected</span>
                    <button class="btn btn-secondary btn-small u-ml-05" id="calendar-bulk-clear" type="button">Clear</button>
                </div>
                <div class="bulk-buttons">
                    <button class="btn btn-secondary" id="calendar-bulk-rollover" type="button" title="Toggle rollover">
                        <i class="fa-solid fa-rotate"></i>
                    </button>
                    <div class="bulk-menu calendar-bulk-menu">
                        <button class="btn-icon bulk-more-btn" id="calendar-bulk-more-btn" type="button" aria-label="More bulk actions" aria-controls="calendar-bulk-more-dropdown" aria-expanded="false">
                            <i class="fa-solid fa-ellipsis-vertical"></i>
                        </button>
                        <div class="bulk-menu-dropdown" id="calendar-bulk-more-dropdown">
                            <button class="bulk-menu-item" id="calendar-bulk-done" type="button">
                                <i class="fa-solid fa-square-check"></i> Mark done
                            </button>
                            <button class="bulk-menu-item" id="calendar-bulk-undone" type="button">
                                <i class="fa-regular fa-square"></i> Mark undone
                            </button>
                            <button class="bulk-menu-item" id="calendar-bulk-priority" type="button">
                                <i class="fa-solid fa-arrow-up-wide-short"></i> Priority
                            </button>
                            <button class="bulk-menu-item" id="calendar-bulk-move" type="button">
                                <i class="fa-solid fa-calendar-day"></i> Move day
                            </button>
                            <button class="bulk-menu-item" id="calendar-bulk-note" type="button">
                                <i class="fa-solid fa-note-sticky"></i> Add note
                            </button>
                        </div>
                    </div>
                    <button class="btn-icon delete" id="calendar-bulk-delete" type="button" title="Delete selected" aria-label="Delete selected calendar items">
                        <i class="fa-solid fa-trash"></i>
                    </button>
                </div>
            </div>
            <div id="calendar-day-layout" class="calendar-day-layout" data-view-mode="timeline">
                <div id="calendar-timeline-wrap" class="calendar-timeline-wrap">
                    <div class="calendar-timeline-header">
                        <div class="calendar-timeline-title">Day Timeline</div>
                        <div class="calendar-timeline-meta" id="calendar-timeline-meta"></div>
                    </div>
                    <div id="calendar-day-timeline" class="calendar-day-timeline"></div>
                    <div class="calendar-unscheduled">
                        <div class="calendar-unscheduled-title">Unscheduled</div>
                        <div id="calendar-unscheduled-items" class="calendar-unscheduled-items"></div>
                    </div>
                </div>
                <div id="calendar-events" class="calendar-events"></div>
            </div>
        </section>

        <section class="calendar-quick-add card" id="calendar-day-quick-add">
            <div class="calendar-input-row">
                <div class="calendar-quick-title">Quick add</div>
                <div class="quick-add-input-wrapper">
                    <textarea id="calendar-quick-input" class="form-control" rows="1" placeholder="Pick a day, then add entries" disabled aria-label="Day quick add input"></textarea>
                    <div id="calendar-autocomplete" class="calendar-autocomplete is-hidden"></div>
                </div>
                <button class="btn-icon calendar-help-btn" id="calendar-help-btn" title="Show syntax help" aria-label="Show syntax help" aria-controls="calendar-autocomplete" aria-expanded="false">
                    <i class="fa-solid fa-circle-question"></i>
                </button>
                <button class="btn-icon calendar-quick-toggle" id="calendar-quick-toggle" aria-label="Minimize quick add" title="Minimize quick add" aria-controls="calendar-day-quick-add" aria-expanded="true">
                    <i class="fa-solid fa-chevron-up"></i>
                </button>
            </div>
        </section>
    </section>

    <!-- Calendar Prompt Modal -->
    <div id="calendar-prompt-modal" class="calendar-prompt-modal is-hidden" role="dialog" aria-modal="true" aria-labelledby="calendar-prompt-title">
        <div class="calendar-prompt-content card" tabindex="-1">
            <h3 id="calendar-prompt-title">Input</h3>
            <p id="calendar-prompt-message" class="calendar-prompt-message"></p>
            <input id="calendar-prompt-input" class="form-control" type="text" value="" aria-label="Calendar input value">
            <div class="calendar-prompt-actions">
                <button class="btn btn-secondary btn-small" id="calendar-prompt-cancel">Cancel</button>
                <button class="btn btn-primary btn-small" id="calendar-prompt-save">Save</button>
            </div>
        </div>
    </div>

    <!-- Calendar Time Edit Modal -->
    <div class="modal" id="calendar-time-modal" role="dialog" aria-modal="true" aria-labelledby="calendar-time-modal-title">
        <div class="modal-content" tabindex="-1">
            <h2 id="calendar-time-modal-title">Edit Time</h2>
            <p id="calendar-time-title" class="u-text-muted u-mt-neg-025"></p>
            <div class="form-group">
                <label for="calendar-time-start">Start time</label>
                <input type="text" id="calendar-time-start" class="form-control" placeholder="e.g., 3:30pm or 15:30">
            </div>
            <div class="form-group">
                <label for="calendar-time-end">End time (optional)</label>
                <input type="text" id="calendar-time-end" class="form-control" placeholder="e.g., 5:00pm">
            </div>
            <div class="form-group">
                <label for="calendar-time-reminder">Reminder (e.g., 30m, 2h, 1d)</label>
                <input type="text" id="calendar-time-reminder" class="form-control" placeholder="e.g., 30m">
            </div>
            <div class="modal-actions">
                <button class="btn" id="calendar-time-cancel">Cancel</button>
                <button class="btn btn-primary" id="calendar-time-save">Save</button>
            </div>
        </div>
    </div>

    <!-- Calendar Recurring Modal -->
    <div class="modal" id="calendar-recurring-modal" role="dialog" aria-modal="true" aria-labelledby="calendar-recurring-modal-title">
        <div class="modal-content recurring-modal-content" tabindex="-1">
            <!-- List View -->
            <div id="recurring-list-view">
                <div class="recurring-header">
                    <h2 id="calendar-recurring-modal-title">Recurring Items</h2>
                    <button class="btn btn-primary btn-small" id="recurring-add-new-btn">
                        <i class="fa-solid fa-plus"></i> Add New
                    </button>
                </div>
                <div id="recurring-list" class="recurring-list">
                    <div class="recurring-empty">Loading...</div>
                </div>
                <div class="modal-actions">
                    <button class="btn" id="calendar-recurring-close">Close</button>
                </div>
            </div>

            <!-- Form View (Add/Edit) -->
            <div id="recurring-form-view" class="is-hidden">
                <div class="recurring-header">
                    <button class="btn-icon" id="recurring-back-btn" title="Back to list" aria-label="Back to recurring list">
                        <i class="fa-solid fa-arrow-left"></i>
                    </button>
                    <h2 id="recurring-form-title">Add Recurring Item</h2>
                </div>
                <input type="hidden" id="calendar-recurring-edit-id" value="">
                <div class="form-group">
                    <label for="calendar-recurring-title">Title</label>
                    <input type="text" id="calendar-recurring-title" class="form-control" placeholder="Title">
                </div>
                <div class="form-group">
                    <label for="calendar-recurring-type">Type</label>
                    <select id="calendar-recurring-type" class="form-control">
                        <option value="task">Task</option>
                        <option value="event">Event</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="calendar-recurring-start-day">Start date</label>
                    <input type="date" id="calendar-recurring-start-day" class="form-control">
                </div>
                <div class="form-group">
                    <label for="calendar-recurring-start-time">Time</label>
                    <div class="recurrence-row">
                        <input type="text" id="calendar-recurring-start-time" class="form-control" placeholder="Start time">
                        <input type="text" id="calendar-recurring-end-time" class="form-control" placeholder="End time">
                    </div>
                </div>
                <div class="form-group">
                    <label for="calendar-recurring-priority">Priority</label>
                    <select id="calendar-recurring-priority" class="form-control">
                        <option value="low">Low</option>
                        <option value="medium" selected>Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="calendar-recurring-reminder">Reminder (e.g., 30m, 2h, 1d)</label>
                    <input type="text" id="calendar-recurring-reminder" class="form-control" placeholder="e.g., 30m">
                </div>
                <div class="form-group">
                    <label class="recurrence-checkbox">
                        <input type="checkbox" id="calendar-recurring-rollover"> Enable rollover
                    </label>
                </div>
                <div class="form-group">
                    <label for="calendar-recurring-frequency">Repeats</label>
                    <select id="calendar-recurring-frequency" class="form-control">
                        <option value="daily">Daily</option>
                        <option value="weekly">Weekly</option>
                        <option value="biweekly">Bi-weekly</option>
                        <option value="monthly">Monthly</option>
                        <option value="monthly_weekday">Monthly (nth weekday)</option>
                        <option value="yearly">Yearly</option>
                        <option value="custom">Custom</option>
                    </select>
                </div>
                <div class="form-group is-hidden" id="calendar-recurring-days-row">
                    <label id="calendar-recurring-days-label">Days of week</label>
                    <div class="recurrence-days">
                        <label><input type="checkbox" value="0"> Mon</label>
                        <label><input type="checkbox" value="1"> Tue</label>
                        <label><input type="checkbox" value="2"> Wed</label>
                        <label><input type="checkbox" value="3"> Thu</label>
                        <label><input type="checkbox" value="4"> Fri</label>
                        <label><input type="checkbox" value="5"> Sat</label>
                        <label><input type="checkbox" value="6"> Sun</label>
                    </div>
                </div>
                <div class="form-group is-hidden" id="calendar-recurring-month-row">
                    <label for="calendar-recurring-day-of-month">Day of month</label>
                    <input type="number" id="calendar-recurring-day-of-month" class="form-control" min="1" max="31">
                </div>
                <div class="form-group is-hidden" id="calendar-recurring-weekday-row">
                    <label for="calendar-recurring-week-of-month">Weekday of month</label>
                    <div class="recurrence-row">
                        <select id="calendar-recurring-week-of-month" class="form-control">
                            <option value="1">1st</option>
                            <option value="2">2nd</option>
                            <option value="3">3rd</option>
                            <option value="4">4th</option>
                            <option value="5">5th (fallback)</option>
                        </select>
                        <select id="calendar-recurring-weekday-of-month" class="form-control">
                            <option value="0">Monday</option>
                            <option value="1">Tuesday</option>
                            <option value="2">Wednesday</option>
                            <option value="3">Thursday</option>
                            <option value="4">Friday</option>
                            <option value="5">Saturday</option>
                            <option value="6">Sunday</option>
                        </select>
                    </div>
                </div>
                <div class="form-group is-hidden" id="calendar-recurring-year-row">
                    <label for="calendar-recurring-month">Month</label>
                    <select id="calendar-recurring-month" class="form-control">
                        <option value="1">January</option>
                        <option value="2">February</option>
                        <option value="3">March</option>
                        <option value="4">April</option>
                        <option value="5">May</option>
                        <option value="6">June</option>
                        <option value="7">July</option>
                        <option value="8">August</option>
                        <option value="9">September</option>
                        <option value="10">October</option>
                        <option value="11">November</option>
                        <option value="12">December</option>
                    </select>
                </div>
                <div class="form-group is-hidden" id="calendar-recurring-custom-row">
                    <label for="calendar-recurring-interval">Every</label>
                    <div class="recurrence-row">
                        <input type="number" id="calendar-recurring-interval" class="form-control" min="1" value="1">
                        <select id="calendar-recurring-interval-unit" class="form-control">
                            <option value="days">Days</option>
                            <option value="weeks">Weeks</option>
                            <option value="months">Months</option>
                            <option value="years">Years</option>
                        </select>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="btn" id="calendar-recurring-cancel">Cancel</button>
                    <button class="btn btn-primary" id="calendar-recurring-save">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Link Note Modal (shared with list view) -->
    <div class="modal" id="link-note-modal" role="dialog" aria-modal="true" aria-labelledby="calendar-link-note-title">
        <div class="modal-content" tabindex="-1">
            <h2 id="calendar-link-note-title">Link Note</h2>
            <p id="link-note-task-label" class="u-text-muted u-mt-neg-025"></p>
            <div class="form-group">
                <label id="calendar-link-note-list-label">Choose an existing note</label>
                <div id="link-note-list" class="note-chooser" aria-labelledby="calendar-link-note-list-label"></div>
            </div>
            <div class="form-group">
                <label for="link-note-new-title">Create a new note</label>
                <input type="text" id="link-note-new-title" class="form-control" placeholder="New note title (optional)">
            </div>
            <div class="modal-actions">
                <button class="btn" data-onclick="closeLinkNoteModal()">
                    <i class="fa-solid fa-xmark note-action-icon"></i>
                    <span class="note-action-text">Cancel</span>
                </button>
                <button class="btn btn-secondary" data-onclick="createAndLinkNote()">
                    <i class="fa-solid fa-plus note-action-icon"></i>
                    <span class="note-action-text">Create & Link</span>
                </button>
                <button class="btn btn-primary" data-onclick="saveLinkedNote()">
                    <i class="fa-solid fa-link note-action-icon"></i>
                    <span class="note-action-text">Attach Selected</span>
                </button>
            </div>
        </div>
    </div>


    <!-- Calendar Item Note Modal -->
    <div class="modal" id="calendar-item-note-modal" role="dialog" aria-modal="true" aria-labelledby="calendar-item-note-title">
        <div class="modal-content" tabindex="-1">
            <h2 id="calendar-item-note-title">Item Note</h2>
            <p id="calendar-item-note-label" class="u-text-muted u-mt-neg-025"></p>
            <div id="calendar-item-note-view" class="calendar-item-note-view"></div>
            <div id="calendar-item-note-editor" class="form-group is-hidden">
                <label for="calendar-item-note-input">Note</label>
                <textarea id="calendar-item-note-input" class="form-control" rows="6" maxlength="{{ item_note_max_chars }}"></textarea>
                <div class="calendar-item-note-counter" id="calendar-item-note-counter"></div>
            </div>
            <div class="modal-actions" id="calendar-item-note-view-actions">
                <button class="btn" id="calendar-item-note-close">Close</button>
                <button class="btn btn-secondary" id="calendar-item-note-edit">Edit</button>
                <button class="btn btn-secondary" id="calendar-item-note-convert">Convert to note</button>
                <button class="btn btn-danger" id="calendar-item-note-delete">Delete</button>
            </div>
            <div class="modal-actions is-hidden" id="calendar-item-note-edit-actions">
                <button class="btn" id="calendar-item-note-cancel">Cancel</button>
                <button class="btn btn-primary" id="calendar-item-note-save">Save</button>
            </div>
        </div>
    </div>
</div>

<script>
    window.USER_TIMEZONE = '{{ default_timezone or "America/New_York" }}';
    window.CALENDAR_ITEM_NOTE_MAX_CHARS = {{ item_note_max_chars or 0 }};
</script>
{% endblock %}

{% block page_scripts %}
<script src="{{ url_for('static', filename='app/core.js') }}" defer></script>
<script src="{{ url_for('static', filename='app/tasks.js') }}" defer></script>
<script src="{{ url_for('static', filename='calendar.js') }}" defer></script>
<script src="{{ url_for('static', filename='app/calendar.js') }}" defer></script>
{% endblock %}




